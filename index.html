<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>I miei animali Preferiti</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <header>
      <h1>I miei animali Preferiti</h1>
    </header>

    <main>
      <figure>
        <img
          src="https://i.pinimg.com/736x/b7/0f/db/b70fdbed72aab2127f8b97f1b007b980.jpg"
          alt="racc"
        />
      </figure>

      <!-- mount componente react -->
      <div class="lista-animali"></div>
    </main>

    <footer>
      <p>Creato con amore da... un collega sbadato! üêæ</p>
    </footer>

    <!-- react in modalit√† diretta -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- babel (per poter usare JSX in un file HTML) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState } = React;

      /* ===== componente modal con portal ==== */
      function Modal({
        title,
        content,
        show = false,
        onClose = () => {},
        onConfirm = () => {},
      }) {
        if (!show) return null;

        return ReactDOM.createPortal(
          <div className="modal-container">
            <div className="modal">
              {title && <h2>{title}</h2>}

              <div className="modal-body">
                {typeof content === "string" ? <p>{content}</p> : content}
              </div>

              <div className="modal-actions">
                <button onClick={onClose}>Annulla</button>
                <button onClick={onConfirm}>Conferma</button>
              </div>
            </div>
          </div>,
          document.body
        );
      }

      /* ==== componente principale (app)====*/
      function AnimalsApp() {
        const [animals, setAnimals] = useState([]);

        // stato modal
        const [isModalOpen, setIsModalOpen] = useState(false);

        // input dell‚Äôutente dentro la modal
        const [animalName, setAnimalName] = useState("");

        // apri modal
        const openModal = () => {
          setAnimalName("");
          setIsModalOpen(true);
        };

        // chiudi modal
        const closeModal = () => setIsModalOpen(false);

        // conferma aggiunta animale
        const confirmAddAnimal = () => {
          if (animalName.trim() !== "") {
            setAnimals([...animals, animalName.trim()]);
          }
          closeModal();
        };

        // ci√≤ che inseriamo come "content" nella modal
        const modalContent = (
          <div>
            <label>Nome animale:</label>
            <input
              type="text"
              value={animalName}
              onChange={(e) => setAnimalName(e.target.value)}
              placeholder="Es: Cane, Gatto..."
            />
          </div>
        );

        return (
          <>
            {/* bottone che apre la modal */}
            <button onClick={openModal}>Aggiungi Animale</button>

            {/* lista animali */}
            <details>
              <summary>Animali ({animals.length})</summary>

              {animals.length === 0 ? (
                <p>Nessun animale ancora. Aggiungine uno!</p>
              ) : (
                <ul>
                  {animals.map((animal, index) => (
                    <li key={index}>{animal}</li>
                  ))}
                </ul>
              )}
            </details>

            {/* modal */}
            <Modal
              title="Aggiungi un animale"
              content={modalContent}
              show={isModalOpen}
              onClose={closeModal}
              onConfirm={confirmAddAnimal}
            />
          </>
        );
      }

      /* ==== mount di react nel DOM ====*/
      const container = document.querySelector(".lista-animali");
      const root = ReactDOM.createRoot(container);
      root.render(<AnimalsApp />);
    </script>
  </body>
</html>
